package require tcltest
namespace import ::tcltest::*

::tcltest::configure {*}$argv

::tcltest::loadTestedCommands

package require automata::btm

test btm-1.0 {3 state, 2 symbol busy beaver} -setup {} -body {
    ::automata::BTM create M
    M compile {
       <A 0/1;R B
        A 1/1;L C
        B 0/1;L A
        B 1/1;R B
        C 0/1;L B
        C 1/1;R H>
    }
    M add E 0
    M run {0}
} -cleanup {
    M destroy
    log::lvSuppressLE i 1
} -result {{{1 1 1 1 1 1 0} 1 H}}

test btm-1.1 {3 state, 2 symbol busy beaver print} -setup {} -body {
    ::automata::BTM create M
    M compile {
       <A 0/1;R B
        A 1/1;L C
        B 0/1;L A
        B 1/1;R B
        C 0/1;L B
        C 1/1;R H>
    }
    M add E 0
    M print
} -cleanup {
    M destroy
    log::lvSuppressLE i 1
} -output {Input symbols   A = {0, 1}
Print symbols   B = {1}
Move symbols    C = {L, N, R}
State symbols   Q = {A, B, C, H}
Erase symbol    E = 0
Start symbol    S = A
Final symbols   F = {H}
Head position   H = 0
Transitions
q0    inp   q1    out
A     0     B     1 R
A     1     C     1 L
B     0     A     1 L
B     1     B     1 R
C     0     B     1 L
C     1     H     1 R
}

test btm-1.3 {4 state, 2 symbol busy beaver} -setup {} -body {
    ::automata::BTM create M
    M add table A 0 B 1 R
    M add table A 1 B 1 L
    M add table B 0 A 1 L
    M add table B 1 C 0 L
    M add table C 0 H 1 R
    M add table C 1 D 1 L
    M add table D 0 D 1 R
    M add table D 1 A 0 R
    M add S A
    M add E 0
    M add F H
    M run {0}
} -cleanup {
    M destroy
    log::lvSuppressLE i 1
} -result {{{1 1 1 1 1 1 1 1 1 1 1 1 0 1 0} 12 H}}

cleanupTests ; return ; # ---------------------------------
