package require tcltest
namespace import ::tcltest::*

::tcltest::configure {*}$argv

::tcltest::loadTestedCommands

package require automata::btm

test btm-1.0 {3 state, 2 symbol busy beaver} -setup {} -body {
    ::automata::BTM create M
    M compile {
        A 0/1;R B
        A 1/1;L C
        B 0/1;L A
        B 1/1;R B
        C 0/1;L B
        C 1/1;R H
    }
    M S set A
    M b set 0
    M F set H
    M run {0}
} -cleanup {
    M destroy
    log::lvSuppressLE i 1
} -result {{{1 1 1 1 1 1 0} H 4}}

test btm-1.1 {3 state, 2 symbol busy beaver print} -setup {} -body {
    ::automata::BTM create M
    M compile {
        A 0/1;R B
        A 1/1;L C
        B 0/1;L A
        B 1/1;R B
        C 0/1;L B
        C 1/1;R H
    }
    M S set A
    M b set 0
    M F set H
    M print
} -cleanup {
    M destroy
    log::lvSuppressLE i 1
} -output {Tape symbols    A = {0, 1}
Init symbols    B = {0, 1}
Blank symbol    b = 0
State symbols   Q = {A, B, C, H}
Start symbol    S = A
Final symbols   F = {H}
Transitions
q0    inp   q1    out
A     0     B     1 R
A     1     C     1 L
B     0     A     1 L
B     1     B     1 R
C     0     B     1 L
C     1     H     1 R
}

test btm-1.3 {4 state, 2 symbol busy beaver} -setup {} -body {
    ::automata::BTM create M
    M T set A 0 B 1 R
    M T set A 1 B 1 L
    M T set B 0 A 1 L
    M T set B 1 C 0 L
    M T set C 0 H 1 R
    M T set C 1 D 1 L
    M T set D 0 D 1 R
    M T set D 1 A 0 R
    M S set A
    M b set 0
    M F set H
    M run {0}
} -cleanup {
    M destroy
    log::lvSuppressLE i 1
} -result {{{1 0 1 1 1 1 1 1 1 1 1 1 1 1 0} H 1}}

cleanupTests ; return ; # ---------------------------------
