package require tcltest
namespace import ::tcltest::*

::tcltest::configure {*}$argv

::tcltest::testConstraint noskip 1

::tcltest::loadTestedCommands

test pda-1.0 {0^n1^n | n >= 0} -setup {
    ::automata::PDA create M
    M T set p 0 p Z A Z
    M T set p 0 p A A A
    M T set p ε q Z Z
    M T set p ε q A A
    M T set q 1 q A
    M T set q ε r Z Z
    M S set p
    M Z set Z
    M F set r
} -body {
    M accept {}
} -cleanup {
    M destroy
    log::lvSuppressLE i 1
} -result 1

test pda-1.1 {} -setup {
    ::automata::PDA create M
    M T set p 0 p Z A Z
    M T set p 0 p A A A
    M T set p ε q Z Z
    M T set p ε q A A
    M T set q 1 q A
    M T set q ε r Z Z
    M S set p
    M Z set Z
    M F set r
} -body {
    M accept {0 0 0 0 1 1 1 1}
} -cleanup {
    M destroy
    log::lvSuppressLE i 1
} -result 1

test pda-1.2 {} -setup {
    ::automata::PDA create M
    M T set p 0 p Z A Z
    M T set p 0 p A A A
    M T set p ε q Z Z
    M T set p ε q A A
    M T set q 1 q A
    M T set q ε r Z Z
    M S set p
    M Z set Z
    M F set r
} -body {
    set res {}
    lappend res [M accept {0 0 0 0 1 1 1 1 1}]
    lappend res [M accept {1 1 0}]
    lappend res [M accept {0 1}]
    lappend res [M accept {0 0 0 1 1 1}]
    set res
} -cleanup {
    M destroy
    log::lvSuppressLE i 1
} -result {0 0 1 1}

if {[package vcompare [package present automata] 2.3] > 0} { 
    cleanupTests ; return 
} 
 

cleanupTests ; return
